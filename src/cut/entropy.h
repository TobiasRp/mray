// Copyright (c) 2020, Tobias Rapp
// All rights reserved.
//
// Redistribution and use in source and binary forms, with or without
// modification, are permitted provided that the following conditions are met:
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Karlsruhe Institute of Technology nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
// ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
// WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
// DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY
// DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
// (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
// LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
// ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
// SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#ifndef ENTROPY_H
#define ENTROPY_H

FUNC float e_log2(float x)
{
    if (x == 0.0f)
        return 0.0f;
    if (x == 1.0f)
        return 0.0f;

    float table[] = {0, -9.99859042974533, -8.99859042974533, -8.413627929024173, -7.998590429745328, -7.676662334857967, -7.413627929024172, -7.191235507687725, -6.998590429745328, -6.828665428303016, -6.676662334857967, -6.539158811108031, -6.413627929024172, -6.298150711604237, -6.191235507687725, -6.09169983413681, -5.998590429745328, -5.911127588494989, -5.828665428303016, -5.750662916301743, -5.676662334857967, -5.6062730069665685, -5.539158811108031, -5.475028473688316, -5.413627929024172, -5.354734239970604, -5.298150711604237, -5.24370292758186, -5.191235507687725, -5.140609434617756, -5.09169983413681, -5.044394119358453, -4.998590429745328, -4.954196310386875, -4.911127588494989, -4.869307412800362, -4.828665428303016, -4.789137064116379, -4.750662916301743, -4.7131882108830805, -4.676662334857967, -4.641038425127245, -4.6062730069665685, -4.57232567504323, -4.539158811108031, -4.5067373334156535, -4.475028473688316, -4.444001578067692, -4.413627929024172, -4.383880585630121, -4.354734239970604, -4.326165087773833, -4.298150711604237, -4.2706699751821295, -4.24370292758186, -4.217230716220669, -4.191235507687725, -4.165700415580587, -4.140609434617756, -4.115947380383488, -4.09169983413681, -4.0678530921824425, -4.044394119358453, -4.021310506245412, -3.9985904297453287, -3.9762226167168744, -3.9541963103868754, -3.9325012392875562, -3.911127588494989, -3.8900659729671596, -3.8693074128003624, -3.8488433102406465, -3.8286654283030166, -3.808765870865311, -3.7891370641163786, -3.769771739249448, -3.750662916301743, -3.7318038890504273, -3.7131882108830805, -3.6948096815682256, -3.676662334857966, -3.658740426860704, -3.641038425127245, -3.6235509983984038, -3.6062730069665685, -3.589199493607627, -3.572325675043231, -3.5556469338966004, -3.5391588111080314, -3.5228569987789307, -3.506737333415654, -3.4907957895466324, -3.4750284736883157, -3.4594316186372973, -3.444001578067691, -3.428734821414381, -3.4136279290241727, -3.398677587558201, -3.3838805856301204, -3.3692338096657193, -3.354734239970604, -3.340378946993534, -3.326165087773833, -3.31208990256211, -3.2981507116042366, -3.284344912079206, -3.2706699751821295, -3.257123443344182, -3.24370292758186, -3.2304061049684023, -3.217230716220669, -3.2041745633952226, -3.1912355076877246, -3.178411467330141, -3.165700415580587, -3.1531003788009535, -3.1406094346177564, -3.128225710161924, -3.1159473803834876, -3.103772666437385, -3.09169983413681, -3.079727192470734, -3.0678530921824425, -3.056075924406089, -3.0443941193584534, -3.0328061450832418, -3.021310506245412, -3.009905742973163, -2.9985904297453287, -2.9873631743220743, -2.9762226167168744, -2.9651674282078786, -2.9541963103868754, -2.943307994244139, -2.9325012392875562, -2.921774832694498, -2.911127588494989, -2.900558346784802, -2.8900659729671596, -2.879649357021821, -2.8693074128003624, -2.859039077346535, -2.8488433102406465, -2.8387190929669393, -2.8286654283030166, -2.8186813397303943, -2.808765870865311, -2.7989180849089643, -2.7891370641163786, -2.779421909283167, -2.769771739249448, -2.7601856904202497, -2.750662916301743, -2.7412025870526766, -2.7318038890504273, -2.722466024471091, -2.7131882108830805, -2.7039696808537017, -2.6948096815682256, -2.6857074744609735, -2.676662334857966, -2.6676735516307115, -2.658740426860704, -2.649862275514251, -2.641038425127245, -2.6322682154995127, -2.6235509983984038, -2.6148861372712764, -2.6062730069665685, -2.5977109934631444, -2.589199493607627, -2.580737914859431, -2.572325675043231, -2.563962202108604, -2.5556469338966004, -2.5473793179129998, -2.5391588111080314, -2.530984879662331, -2.5228569987789307, -2.5147746524810723, -2.506737333415654, -2.498744542662123, -2.4907957895466324, -2.482890591461286, -2.4750284736883157, -2.4672089692290164, -2.4594316186372973, -2.451695969857692, -2.444001578067691, -2.436348005524256, -2.428734821414381, -2.42116160170958, -2.4136279290241727, -2.406133392477248, -2.398677587558201, -2.391260115995718, -2.3838805856301204, -2.3765386102889523, -2.3692338096657193, -2.36196580920168, -2.354734239970604, -2.3475387385664, -2.340378946993534, -2.3332545125601527, -2.326165087773833, -2.3191103302398828, -2.31208990256211, -2.3051034722460035, -2.2981507116042366, -2.2912312976644458, -2.284344912079206, -2.2774912410381436, -2.2706699751821295, -2.2638808095194904, -2.257123443344182, -2.250397580155868, -2.24370292758186, -2.237039197300849, -2.2304061049684023, -2.223803370144155, -2.217230716220669, -2.210687870353897, -2.2041745633952226, -2.197690529825024, -2.1912355076877246, -2.184809238528292, -2.178411467330141, -2.1720419424544137, -2.165700415580587, -2.1593866416483847, -2.1531003788009535, -2.146841388329271, -2.1406094346177564, -2.1344042850910485, -2.128225710161924, -2.122073483180329, -2.1159473803834876, -2.1098471808470696, -2.103772666437385, -2.09772362176458, -2.09169983413681, -2.085701093515367, -2.079727192470734, -2.0737779261395475, -2.0678530921824425, -2.061952490742758, -2.056075924406089, -2.050223198160651, -2.0443941193584534, -2.0385884976772477, -2.0328061450832418, -2.027046875794557, -2.021310506245412, -2.0155968550510184, -2.009905742973163, -2.0042369928864705, -1.9985904297453287, -1.9929658805514505, -1.9873631743220745, -1.9817821420587747, -1.9762226167168742, -1.9706844331754443, -1.9651674282078784, -1.9596714404530264, -1.9541963103868754, -1.9487418802947671, -1.9433079942441391, -1.9378944980577748, -1.9325012392875562, -1.9271280671887046, -1.921774832694498, -1.916441388391457, -1.9111275884949892, -1.9058332888254763, -1.900558346784802, -1.8953026213333068, -1.8900659729671596, -1.8848482636961403, -1.8796493570218213, -1.8744691179161412, -1.8693074128003624, -1.8641641095244026, -1.8590390773465353, -1.8539321869134464, -1.8488433102406467, -1.8437723206932248, -1.8387190929669395, -1.833683503069641, -1.8286654283030164, -1.8236647472446497, -1.818681339730394, -1.8137150868370446, -1.8087658708653114, -1.8038335753230808, -1.798918084908964, -1.794019285496125, -1.7891370641163789, -1.7842713089445628, -1.779421909283167, -1.7745887555472235, -1.7697717392494476, -1.7649707529856264, -1.7601856904202497, -1.7554164462723776, -1.750662916301743, -1.7459249972950799, -1.7412025870526768, -1.7364955843751493, -1.7318038890504273, -1.7271274018409541, -1.722466024471091, -1.7178196596147262, -1.7131882108830803, -1.7085715828127104, -1.7039696808537017, -1.6993824113580498, -1.6948096815682256, -1.6902513996059214, -1.6857074744609732, -1.6811778159804593, -1.6766623348579663, -1.6721609426230255, -1.6676735516307117, -1.6632000750514038, -1.658740426860704, -1.6542945218295118, -1.6498622755142511, -1.6454436042472462, -1.641038425127245, -1.6366466560100872, -1.632268215499513, -1.627903022938111, -1.623550998398404, -1.6192120626740665, -1.6148861372712764, -1.6105731444001938, -1.6062730069665685, -1.6019856485634703, -1.5977109934631444, -1.5934489666089848, -1.589199493607627, -1.5849625007211563, -1.580737914859431, -1.5765256635725164, -1.5723256750432308, -1.5681378780797974, -1.5639622021086041, -1.559798577167068, -1.5556469338966004, -1.5515072035356765, -1.547379317913, -1.5432632094407681, -1.5391588111080312, -1.5350660564741483, -1.530984879662331, -1.5269152153532841, -1.5228569987789309, -1.518810165716229, -1.5147746524810721, -1.5107503959222772, -1.5067373334156537, -1.5027354028581577, -1.4987445426621233, -1.4947646917495778, -1.4907957895466324, -1.486837775977949, -1.4828905914612862, -1.4789541769021157, -1.4750284736883157, -1.4711134236849326, -1.4672089692290164, -1.4633150531245254, -1.4594316186372973, -1.4555586094900907, -1.451695969857692, -1.4478436443620855, -1.4440015780676911, -1.4401697164766643, -1.436348005524256, -1.4325363915742368, -1.4287348214143807, -1.4249432422520065, -1.42116160170958, -1.4173898478203715, -1.4136279290241724, -1.4098757941630649, -1.4061333924772483, -1.4024006736009182, -1.398677587558201, -1.3949640847591367, -1.391260115995718, -1.3875656324379764, -1.3838805856301204, -1.3802049274867223, -1.3765386102889525, -1.3728815866808635, -1.369233809665719, -1.3655952326023708, -1.3619658092016798, -1.3583454935229828, -1.354734239970604, -1.3511320032904084, -1.3475387385664002, -1.3439544012173614, -1.3403789469935339, -1.3368123319733416, -1.3332545125601525, -1.3297054454790818, -1.3261650877738331, -1.32263339680358, -1.3191103302398828, -1.3155958460636459, -1.3120899025621104, -1.3085924583258834, -1.3051034722460035, -1.3016229035110416, -1.2981507116042366, -1.294686856300665, -1.2912312976644458, -1.287783996045977, -1.2843449120792059, -1.2809140066789324, -1.2774912410381434, -1.2740765766253788, -1.2706699751821293, -1.2672713987202644, -1.2638808095194904, -1.2604981701248381, -1.2571234433441816, -1.253756592245783, -1.2503975801558682, -1.2470463706562305, -1.24370292758186, -1.2403672150186038, -1.2370391973008492, -1.233718839009238, -1.2304061049684023, -1.2271009602447303, -1.2238033701441553, -1.2205133002099704, -1.217230716220669, -1.213955584187808, -1.210687870353897, -1.2074275411903104, -1.2041745633952228, -1.2009289038915685, -1.197690529825024, -1.1944594085620108, -1.1912355076877246, -1.1880187950041816, -1.1848092385282916, -1.1816068064899476, -1.178411467330141, -1.1752231896990937, -1.1720419424544137, -1.16886769465927, -1.165700415580587, -1.162540074687259, -1.1593866416483847, -1.1562400863315208, -1.1531003788009535, -1.1499674893159908, -1.1468413883292712, -1.1437220464850923, -1.1406094346177567, -1.137503523749935, -1.1344042850910485, -1.1313116900356668, -1.1282257101619242, -1.125146317229952, -1.122073483180329, -1.1190071801325456, -1.1159473803834874, -1.1128940564059335, -1.1098471808470696, -1.1068067265270185, -1.1037726664373853, -1.1007449737398172, -1.0977236217645803, -1.0947085840091484, -1.09169983413681, -1.0886973459752867, -1.085701093515367, -1.0827110509095554, -1.0797271924707341, -1.0767494926708385, -1.0737779261395477, -1.0708124676629864, -1.0678530921824423, -1.0648997747930948, -1.061952490742758, -1.0590112154306355, -1.0560759244060887, -1.0531465933674171, -1.050223198160651, -1.0473057147783567, -1.0443941193584534, -1.0414883881830423, -1.0385884976772477, -1.0356944244080681, -1.0328061450832415, -1.0299236365501203, -1.0270468757945566, -1.0241758399398015, -1.0213105062454122, -1.0184508521061715, -1.0155968550510186, -1.012748492741988, -1.0099057429731628, -1.0070685836696334, -1.0042369928864707, -1.0014109488077072, -0.9985904297453286, -0.9957754141382746, -0.9929658805514505, -0.9901618076747479, -0.9873631743220745, -0.984569959430394, -0.9817821420587748, -0.9789997013874479, -0.9762226167168742, -0.9734508674668204, -0.9706844331754442, -0.9679232934983873, -0.9651674282078784, -0.9624168171918437, -0.9596714404530263, -0.9569312781081141, -0.9541963103868752, -0.951466517631303, -0.9487418802947671, -0.946022378941175, -0.9433079942441391, -0.9405987069861529, -0.9378944980577748, -0.9351953484568194, -0.9325012392875562, -0.929812151759916, -0.9271280671887046, -0.9244489669928232, -0.9217748326944978, -0.9191056459185134, -0.9164413883914572, -0.9137820419409671, -0.9111275884949893, -0.90847801008104, -0.9058332888254763, -0.9031934069527722, -0.9005583467848021, -0.8979280907401301, -0.8953026213333067, -0.8926819211741711, -0.8900659729671597, -0.8874547595106217, -0.8848482636961404, -0.8822464685078605, -0.8796493570218213, -0.877056912405297, -0.8744691179161412, -0.8718859569021387, -0.8693074128003623, -0.8667334691365359, -0.8641641095244027, -0.8615993176650992, -0.8590390773465352, -0.8564833724427787, -0.8539321869134464, -0.8513855048030999, -0.8488433102406467, -0.8463055874387468, -0.8437723206932247, -0.841243494382486, -0.8387190929669394, -0.8361991009884239, -0.833683503069641, -0.8311722839135912, -0.8286654283030164, -0.826162921099846, -0.8236647472446497, -0.8211708917560919, -0.818681339730394, -0.8161960763407996, -0.8137150868370446, -0.8112383565448321, -0.8087658708653113, -0.8062976152745617, -0.8038335753230806, -0.8013737366352763, -0.7989180849089641, -0.7964666059148678, -0.7940192854961249, -0.7915761095677961, -0.7891370641163787, -0.7867021351993249, -0.7842713089445628, -0.7818445715500227, -0.779421909283167, -0.7770033084805236, -0.7745887555472235, -0.7721782369565429, -0.7697717392494476, -0.7673692490341432, -0.7649707529856266, -0.7625762378452438, -0.7601856904202496, -0.7577990975833717, -0.7554164462723777, -0.7530377234896465, -0.7506629163017431, -0.7482920118389962, -0.74592499729508, -0.7435618599265991, -0.7412025870526768, -0.738847166054547, -0.7364955843751492, -0.7341478295187264, -0.7318038890504273, -0.7294637505959107, -0.727127401840954, -0.724794830531064, -0.7224660244710911, -0.7201409715248472, -0.717819659614726, -0.7155020767213267, -0.7131882108830803, -0.7108780501958792, -0.7085715828127103, -0.7062687969432897, -0.7039696808537016, -0.7016742228660394, -0.6993824113580498, -0.6970942347627797, -0.6948096815682258, -0.6925287403169873, -0.6902513996059214, -0.6879776480858004, -0.6857074744609732, -0.6834408674890282, -0.6811778159804592, -0.6789183087983343, -0.6766623348579663, -0.6744098831265877, -0.6721609426230255, -0.6699155024173813, -0.6676735516307116, -0.6654350794347121, -0.6632000750514038, -0.6609685277528211, -0.6587404268607039, -0.6565157617461902, -0.6542945218295119, -0.6520766965796931, -0.6498622755142511, -0.6476512481988979, -0.6454436042472461, -0.6432393333205161, -0.641038425127245, -0.6388408694229991, -0.6366466560100872, -0.634455774737277, -0.632268215499513, -0.630083968237637, -0.627903022938111, -0.625725369632741, -0.6235509983984039, -0.6213798993567767, -0.6192120626740666, -0.6170474785607437, -0.6148861372712765, -0.6127280291038678, -0.610573144400194, -0.6084214735451452, -0.6062730069665684, -0.6041277351350116, -0.6019856485634703, -0.5998467378071355, -0.5977109934631444, -0.595578406170332, -0.5934489666089848, -0.591322665500597, -0.5891994936076269, -0.5870794417332575, -0.5849625007211563, -0.5828486614552383, -0.5807379148594308, -0.5786302518974397, -0.5765256635725164, -0.5744241409272286, -0.5723256750432308, -0.5702302570410374, -0.5681378780797973, -0.5660485293570702, -0.5639622021086041, -0.561878887608115, -0.5597985771670678, -0.5577212621344589, -0.5556469338966005, -0.5535755838769056, -0.5515072035356765, -0.5494417843698923, -0.547379317913, -0.5453197957347056, -0.543263209440768, -0.5412095506727935, -0.5391588111080313, -0.5371109824591727, -0.5350660564741483, -0.5330240249359297, -0.5309848796623311, -0.5289486125058124, -0.5269152153532841, -0.5248846801259133, -0.5228569987789308, -0.5208321633014404, -0.5188101657162288, -0.5167909980795767, -0.5147746524810721, -0.5127611210434239, -0.5107503959222772, -0.5087424693060307, -0.5067373334156539, -0.504734980504506, -0.5027354028581575, -0.5007385927942107, -0.4987445426621232, -0.49675324484303174, -0.4947646917495779, -0.4927788758257342, -0.49079578954663233, -0.4888154254183915, -0.486837775977949, -0.48486283379289125, -0.4828905914612861, -0.4809210416115167, -0.47895417690211584, -0.47698999002160186, -0.47502847368831574, -0.4730696206502589, -0.47111342368493253, -0.46915987559917766, -0.46720896922901645, -0.4652606974394948, -0.4633150531245253, -0.46137202920673237, -0.4594316186372972, -0.45749381439580467, -0.45555860949009086, -0.4536259969560915, -0.45169596985769195, -0.44976852128657757, -0.4478436443620854, -0.44592133223105684, -0.44400157806769125, -0.4420843750734004, -0.44016971647666436, -0.43825759553288735, -0.43634800552425596, -0.43444093975959697, -0.43253639157423696, -0.4306343543298623, -0.4287348214143808, -0.4268377862417832, -0.4249432422520066, -0.4230511829107982, -0.42116160170957995, -0.41927449216531454, -0.4173898478203716, -0.4155076622423952, -0.41362792902417245, -0.4117506417835021, -0.40987579416306497, -0.4080033798302944, -0.4061333924772482, -0.40426582582048126, -0.40240067360091836, -0.40053792958372875, -0.398677587558201, -0.3968196413376186, -0.39496408475913675, -0.39311091168365947, -0.39126011599571797, -0.3894116916033494, -0.38756563243797637, -0.385721932454288, -0.38388058563012045, -0.3820415859663393, -0.38020492748672224, -0.3783706042378423, -0.3765386102889524, -0.37470893973187014, -0.3728815866808634, -0.3710565452725369, -0.36923380966571906, -0.36741337404135027, -0.3655952326023709, -0.363779379573611, -0.36196580920167987, -0.3601545157548569, -0.3583454935229829, -0.35653873681735193, -0.354734239970604, -0.35293199733661856, -0.3511320032904084, -0.34933425222801423, -0.3475387385664001, -0.3457454567433494, -0.3439544012173613, -0.34216556646754837, -0.340378946993534, -0.33859453731535116, -0.33681233197334165, -0.33503232552805573, -0.3332545125601525, -0.331478887670301, -0.3297054454790817, -0.32793418062688884, -0.32616508777383313, -0.3243981615996453, -0.3226333968035799, -0.32087078810432007, -0.31911033023988267, -0.31735201796752394, -0.3155958460636458, -0.31384180932370304, -0.31208990256211033, -0.3103401206121506, -0.3085924583258834, -0.30684691057405405, -0.3051034722460035, -0.30336213824957836, -0.30162290351104165, -0.29988576297498426, -0.29815071160423656, -0.2964177443797809, -0.29468685630066493, -0.292958042383914, -0.29123129766444583, -0.2895066171949848, -0.287783996045977, -0.2860634293055053, -0.2843449120792059, -0.28262843949018435, -0.28091400667893246, -0.2792016088032463, -0.27749124103814343, -0.2757828985757819, -0.2740765766253788, -0.27237227041312995, -0.2706699751821294, -0.26896968619229006, -0.26727139872026445, -0.2655751080593659, -0.26388080951949033, -0.2621884984270384, -0.2604981701248382, -0.25880981997206837, -0.25712344334418163, -0.25543903563282877, -0.253756592245783, -0.252076108606865, -0.2503975801558683, -0.24872100234848463, -0.24704637065623047, -0.2453736805663736, -0.24370292758186005, -0.24203410722124163, -0.2403672150186037, -0.23870224652349362, -0.2370391973008493, -0.23537806293092842, -0.23371883900923796, -0.23206152114646403, -0.23040610496840225, -0.22875258611588858, -0.22710096024473025, -0.22545122302563747, -0.22380337014415522, -0.22215739730059555, -0.22051330020997043, -0.21887107460192456, -0.21723071622066903, -0.215592220824915, -0.21395558418780805, -0.21232080209686263, -0.21068787035389705, -0.20905678477496883, -0.20742754119031032, -0.20580013544426476, -0.20417456339522266, -0.20255082091555868, -0.20092890389156853, -0.19930880822340666, -0.19769052982502391, -0.1960740646241058, -0.19445940856201088, -0.19284655759370986, -0.19123550768772454, -0.18962625482606743, -0.1880187950041817, -0.18641312423088133, -0.1848092385282916, -0.18320713393179006, -0.1816068064899477, -0.18000825226447043, -0.17841146733014096, -0.17681644777476097, -0.17522318969909356, -0.17363168921680622, -0.17204194245441368, -0.17045394555122156, -0.16886769465927004, -0.16728318594327793, -0.16570041558058698, -0.16411937976110666, -0.16254007468725898, -0.16096249657392386, -0.15938664164838473, -0.15781250615027428, -0.15624008633152073, -0.15466937845629417, -0.15310037880095345, -0.15153308365399312, -0.14996748931599072, -0.14840359209955448, -0.14684138832927113, -0.1452808743416542, -0.1437220464850923, -0.14216490111979796, -0.14060943461775657, -0.13905564336267578, -0.13750352374993496, -0.135953072186535, -0.13440428509104846, -0.13285715889356997, -0.13131169003566678, -0.12976787497032968, -0.1282257101619242, -0.12668519208614187, -0.12514631722995218, -0.12360908209155419, -0.12207348318032898, -0.12053951701679196, -0.11900718013254552, -0.11747646907023214, -0.11594738038348745, -0.11441991063689372, -0.11289405640593352, -0.11136981427694373, -0.10984718084706961, -0.10832615272421933, -0.10680672652701853, -0.10528889888476528, -0.10377266643738521, -0.10225802583538682, -0.10074497373981718, -0.0992335068222177, -0.09772362176458017, -0.09621531525930317, -0.09470858400914849, -0.0932034247271979, -0.09169983413681003, -0.09019780897157814, -0.08869734597528663, -0.08719844190186926, -0.08570109351536695, -0.0842052975898858, -0.08271105090955541, -0.08121835026848738, -0.07972719247073407, -0.07823757433024749, -0.07674949267083855, -0.07526294432613632, -0.07377792613954767, -0.07229443496421704, -0.07081246766298642, -0.06933202110835554, -0.06785309218244231, -0.06637567777694335, -0.06489977479309485, -0.06342538014163358, -0.06195249074275803, -0.06048110352608987, -0.059011215430635526, -0.05754282340474798, -0.056075924406088724, -0.05461051540158998, -0.05314659336741707, -0.05168415528893094, -0.05022319816065095, -0.04876371898621779, -0.047305714778356635, -0.04584918255884043, -0.044394119358453395, -0.04294052221695473, -0.04148838818304244, -0.04003771431431742, -0.038588497677247674, -0.03714073534713269, -0.03569442440806808, -0.03424956195291029, -0.032806145083241575, -0.0313641709093351, -0.029923636550120213, -0.028484539133147954, -0.02704687579455663, -0.025610643679037662, -0.024175839939801533, -0.022742461738543954, -0.021310506245412156, -0.01987997063897139, -0.018450852106171544, -0.017023147842313985, -0.015596855051018503, -0.014171970944190473, -0.012748492741988133, -0.01132641767279006, -0.009905742973162785, -0.008486465887828568, -0.007068583669633345, -0.005652093579514817, -0.004236992886470705, -0.0028232788675271567, -0.001410948807707308, 0.0};
    return table[static_cast<int>(x * 1024)];
}

FUNC float entropy_ln(float x)
{
    if (x == 0.0f)
        return 0.0f;

    float table[] = {0, -6.930494765951626, -6.2373475853916815, -5.831882477283517, -5.544200404831736, -5.321056853517526, -5.1387352967235715, -4.9845846168963135, -4.851053224271791, -4.733270188615407, -4.627909672957581, -4.532599493153256, -4.445588116163626, -4.36554540849009, -4.291437436336368, -4.222444564849416, -4.157906043711845, -4.097281421895411, -4.0401230080554615, -3.986055786785186, -3.9347624923976356, -3.8859723282282035, -3.8394523125933104, -3.795000550022477, -3.7524409356036807, -3.711618941083426, -3.6723982279301444, -3.6346578999472974, -3.5982902557764227, -3.5631989359651524, -3.529297384289471, -3.4965075614664802, -3.4647588631519, -3.4339872044851463, -3.404134241335465, -3.375146704462213, -3.3469758274955166, -3.319576853307402, -3.292908606225241, -3.26693311982198, -3.2416153118376902, -3.2169226992473186, -3.192825147668258, -3.169294650258064, -3.146305132033365, -3.123832276181307, -3.1018533694625314, -3.080347164241568, -3.0592937550437354, -3.038674467841, -3.0184717605234805, -2.9986691332273008, -2.9792510473701994, -2.9602028523995045, -2.941510719387352, -2.9231615807191553, -2.9051430752164773, -2.8874434981170762, -2.870051755405207, -2.8529573220459072, -2.8361502037295256, -2.819620901778315, -2.803360380906535, -2.787360039560094, -2.7716116825919546, -2.7561074960559893, -2.740840023925201, -2.7258021465606603, -2.71098706077552, -2.6963882613543673, -2.6819995239022676, -2.667814888910311, -2.653828646935571, -2.640035324803235, -2.6264296727474568, -2.613006652415316, -2.5997614256652954, -2.5866893440979424, -2.573785939262035, -2.561046913484605, -2.548468131277745, -2.536045611279188, -2.5237755186873736, -2.5116541581550287, -2.4996779671083127, -2.4878435094613103, -2.4761474696981187, -2.464586647297043, -2.45315795147342, -2.4418583962194864, -2.4306850956213615, -2.4196352594347763, -2.408706188902586, -2.3978952727983707, -2.3871999836816227, -2.3766178743510857, -2.3661465744837904, -2.3557837874482437, -2.3455272872810546, -2.3353749158170367, -2.325324579963535, -2.3153742491103673, -2.3055219526673554, -2.2957657777219906, -2.286103866810254, -2.276534415794103, -2.267055671839559, -2.2576659314897203, -2.2483635388274066, -2.2391468837224826, -2.2300144001592104, -2.220964564639292, -2.211995894656532, -2.203106947239286, -2.194296317557131, -2.1855626375883763, -2.176904574845262, -2.16832083115387, -2.159810141485962, -2.1513712728400973, -2.1430030231695802, -2.134704220354885, -2.1264737212183698, -2.118310410579209, -2.1102132003465894, -2.1021810286493254, -2.0942128590001485, -2.0863076794930353, -2.078464502032009, -2.0706823615899546, -2.062960315496044, -2.055297442750475, -2.0476928433652555, -2.040145637729873, -2.032654966000715, -2.025219987513197, -2.0178398802155746, -2.0105138401235014, -2.003241080794422, -1.9960208328209348, -1.9888523433423222, -1.9817348755734583, -1.9746677083503659, -1.9676501356917193, -1.960681466375626, -1.953761023531052, -1.94688814424329, -1.94006217917289, -1.9332824921875114, -1.9265484600061673, -1.9198594718553708, -1.913214929136702, -1.90661424510535, -1.900056844559191, -1.8935421635379972, -1.8870696490323797, -1.8806387587020894, -1.8742489606033184, -1.8678997329246596, -1.861590563731395, -1.8553209507177995, -1.8490904009671636, -1.8428984307192424, -1.8367445651448642, -1.830628338127428, -1.824549292051046, -1.8185069775950833, -1.8125009535348715, -1.8065307865483675, -1.800596051028553, -1.7946963289013649, -1.7888312094489667, -1.7830002891381735, -1.7772031714538477, -1.7714394667370976, -1.7657087920281125, -1.7600107709134747, -1.7543450333777972, -1.7487112156595412, -1.7431089601108714, -1.737537915061416, -1.7319977346858006, -1.7264880788748311, -1.7210086131102056, -1.7155590083426409, -1.7101389408733016, -1.7047480922384253, -1.6993861490970399, -1.6940528031216773, -1.6887477508919841, -1.6834706937911403, -1.6782213379049966, -1.672999393923845, -1.667804577046741, -1.6626366068882983, -1.6574952073878797, -1.6523801067211092, -1.647291037213638, -1.6422277352570913, -1.637189941227134, -1.6321773994035897, -1.6271898578925508, -1.6222270685504219, -1.6172887869098391, -1.6123747721074102, -1.6074847868132183, -1.6026185971620455, -1.5977759726862575, -1.5929566862503086, -1.5881605139868153, -1.5833872352341578, -1.5786366324755599, -1.573908491279614, -1.5692026002422013, -1.5645187509297749, -1.5598567378239636, -1.5552163582674614, -1.550597412411167, -1.5459997031625374, -1.5414230361351255, -1.536867219599265, -1.5323320644338736, -1.527817384079347, -1.5233229944915077, -1.5188487140965867, -1.5143943637472064, -1.5099597666793405, -1.5055447484702238, -1.5011491369971857, -1.4967727623973868, -1.4924154570284311, -1.488077055429833, -1.4837573942853166, -1.479456312385926, -1.475173650593925, -1.4709092518074676, -1.4666629609260164, -1.4624346248164954, -1.458224092280152, -1.454031214020116, -1.449855842609635, -1.4456978324609715, -1.44155703979494, -1.437433322611078, -1.4333265406584246, -1.4292365554068995, -1.4251632300192636, -1.4211064293236493, -1.4170660197866443, -1.413041869486919, -1.40903384808938, -1.4050418268198426, -1.4010656784402031, -1.3971052772241062, -1.39316049893309, -1.3892312207932003, -1.385317321472064, -1.3814186810564066, -1.3775351810300092, -1.3736667042520887, -1.3698131349360987, -1.365974358628933, -1.3621502621905297, -1.358340733773862, -1.3545456628053103, -1.3507649399654043, -1.3469984571699274, -1.343246107551377, -1.3395077854407698, -1.3357833863497874, -1.3320728069532517, -1.3283759450719257, -1.3246926996556292, -1.3210229707666667, -1.3173666595635563, -1.3137236682850553, -1.3100939002344765, -1.306477259764288, -1.3028736522609894, -1.2992829841302609, -1.295705162782377, -1.2921400966178809, -1.288587695013513, -1.285047868308389, -1.2815205277904205, -1.278005585682976, -1.274502955131774, -1.2710125501920055, -1.2675342858156806, -1.2640680778391942, -1.2606138429711067, -1.257171498780134, -1.2537409636833448, -1.250322156934559, -1.2469149986129449, -1.2435194096118065, -1.240135311627566, -1.2367626271489267, -1.233401279446222, -1.23005119256094, -1.2267122912954254, -1.2233845012027507, -1.2200677485767568, -1.2167619604422573, -1.2134670645454047, -1.2101829893442149, -1.2069096639992456, -1.2036470183644292, -1.200394982978052, -1.197153489053881, -1.1939224684724346, -1.1907018537723923, -1.187491578142144, -1.1842915754114733, -1.1811017800433732, -1.1779221271259934, -1.1747525523647144, -1.1715929920743458, -1.1684433831714496, -1.165303663166782, -1.1621737701578543, -1.1590536428216107, -1.1559432204072182, -1.1528424427289699, -1.149751250159297, -1.146669583621889, -1.1435973845849188, -1.140534595054373, -1.1374811575674828, -1.1344370151862546, -1.1314021114911006, -1.1283763905745636, -1.1253597970351379, -1.1223522759711826, -1.119353772974926, -1.11636423412656, -1.1133836059884223, -1.1104118355992647, -1.1074488704686078, -1.1044946585711763, -1.1015491483414195, -1.0986122886681098, -1.0956840288890213, -1.0927643187856866, -1.0898531085782281, -1.0869503489202668, -1.0840559908939023, -1.0811699860047674, -1.0782922861771522, -1.0754228437491995, -1.072561611468167, -1.0697085424857609, -1.0668635903535293, -1.0640267090183297, -1.061197852817852, -1.0583769764762105, -1.055564035099596, -1.0527589841719873, -1.0499617795509262, -1.0471723774633475, -1.0443907345014707, -1.0416168076187455, -1.0388505541258555, -1.0360919316867756, -1.0333408983148857, -1.0305974123691348, -1.0278614325502602, -1.025132917897056, -1.0224118277826955, -1.0196981219110992, -1.0169917603133563, -1.0142927033441913, -1.0116009116784799, -1.008916346307811, -1.0062389685370945, -1.0035687399812157, -1.0009056225617319, -0.9982495785036157, -0.9956005703320387, -0.9929585608692001, -0.990323513231195, -0.9876953908249255, -0.9850741573450513, -0.9824597767709805, -0.9798522133638996, -0.9772514316638422, -0.9746573964867956, -0.9720700729218447, -0.969489426328353, -0.9669154223331802, -0.9643480268279344, -0.9617872059662608, -0.959232926161164, -0.9566851540823653, -0.9541438566536927, -0.9516090010505046, -0.9490805546971459, -0.9465584852644361, -0.9440427606671888, -0.9415333490617631, -0.9390302188436446, -0.9365333386450574, -0.9340426773326055, -0.9315582040049435, -0.9290798879904765, -0.9266076988450874, -0.9241416063498938, -0.9216815805090316, -0.9192275915474648, -0.9167796099088248, -0.9143376062532731, -0.911901551455392, -0.9094714166021002, -0.9070471729905938, -0.9046287921263122, -0.9022162457209283, -0.8998095056903632, -0.897408544152825, -0.8950133334268701, -0.8926238460294887, -0.8902400546742124, -0.887861932269245, -0.8854894519156146, -0.8831225869053485, -0.8807613107196687, -0.8784055970272096, -0.876055419682256, -0.8737107527230019, -0.8713715703698296, -0.8690378470236094, -0.8667095572640183, -0.8643866758478786, -0.8620691777075161, -0.8597570379491366, -0.8574502318512216, -0.8551487348629424, -0.8528525226025921, -0.8505615708560363, -0.8482758555751804, -0.8459953528764551, -0.8437200390393196, -0.8414498905047805, -0.8391848838739283, -0.8369249959064908, -0.8346702035194017, -0.8324204837853862, -0.8301758139315624, -0.8279361713380576, -0.8257015335366413, -0.8234718782093722, -0.8212471831872611, -0.8190274264489481, -0.8168125861193953, -0.8146026404685924, -0.8123975679102785, -0.810197347000676, -0.8080019564372404, -0.8058113750574218, -0.8036255818374416, -0.8014445558910813, -0.7992682764684859, -0.797096722954978, -0.7949298748698876, -0.7927677118653924, -0.7906102137253712, -0.7884573603642702, -0.7863091318259806, -0.7841655082827292, -0.7820264700339797, -0.7798919975053472, -0.7777620712475223, -0.7756366719352088, -0.7735157803660712, -0.7713993774596936, -0.76928744425655, -0.7671799619169853, -0.7650769117202065, -0.7629782750632853, -0.7608840334601705, -0.7587941685407114, -0.7567086620496898, -0.7546274958458652, -0.7525506519010261, -0.7504781122990537, -0.7484098592349947, -0.7463458750141433, -0.7442861420511326, -0.7422306428690366, -0.7401793600984793, -0.7381322764767544, -0.7360893748469541, -0.7340506381571059, -0.7320160494593183, -0.7299855919089363, -0.727959248763704, -0.7259370033829361, -0.723918839226699, -0.7219047398549977, -0.7198946889269735, -0.7178886702001078, -0.7158866675294348, -0.7138886648667616, -0.7118946462598973, -0.7099045958518873, -0.7079184978802578, -0.7059363366762667, -0.703958096664161, -0.7019837623604434, -0.7000133183731446, -0.6980467494011038, -0.696084040233255, -0.6941251757479221, -0.6921701409121187, -0.690218920780857, -0.6882715004964614, -0.6863278652878904, -0.6843880004700638, -0.6824518914431974, -0.6805195236921434, -0.6785908827857379, -0.6766659543761535, -0.6747447241982596, -0.6728271780689877, -0.6709133018867036, -0.6690030816305843, -0.6670965033600028, -0.6651935532139166, -0.6632942174102642, -0.661398482245365, -0.6595063340933272, -0.657617759405459, -0.6557327447096877, -0.6538512766099821, -0.6519733417857819, -0.6500989269914317, -0.64822801905562, -0.6463606048808246, -0.6444966714427618, -0.6426362057898422, -0.6407791950426294, -0.6389256263933064, -0.637075487105145, -0.6352287645119803, -0.6333854460176911, -0.6315455190956839, -0.6297089712883824, -0.6278757902067215, -0.6260459635296454, -0.624219479003611, -0.6223963244420959, -0.62057648772511, -0.6187599567987121, -0.6169467196745312, -0.6151367644292918, -0.6133300792043428, -0.6115266522051921, -0.6097264717010442, -0.6079295260243426, -0.6061358035703156, -0.6043452927965274, -0.6025579822224316, -0.6007738604289302, -0.5989929160579355, -0.5972151378119361, -0.5954405144535677, -0.5936690348051856, -0.5919006877484436, -0.5901354622238745, -0.5883733472304752, -0.5866143318252957, -0.5848584051230308, -0.5831055562956163, -0.5813557745718286, -0.579609049236887, -0.5778653696320601, -0.5761247251542762, -0.5743871052557353, -0.5726524994435268, -0.5709208972792489, -0.5691922883786311, -0.5674666624111614, -0.5657440090997151, -0.5640243182201886, -0.562307579601134, -0.5605937831233994, -0.5588829187197699, -0.5571749763746138, -0.55546994612353, -0.5537678180529995, -0.5520685823000397, -0.5503722290518612, -0.5486787485455282, -0.5469881310676207, -0.5453003669539009, -0.5436154465889815, -0.5419333604059966, -0.5402540988862766, -0.5385776525590243, -0.5369040120009947, -0.535233167836177, -0.5335651107354801, -0.5318998314164188, -0.5302373206428054, -0.528577569224441, -0.5269205680168115, -0.525266307920785, -0.523614779882312, -0.5219659748921281, -0.5203198839854595, -0.5186764982417295, -0.5170358087842695, -0.5153978067800311, -0.5137624834393003, -0.512129830015415, -0.5104998378044839, -0.5088724981451086, -0.5072478024181066, -0.5056257420462387, -0.5040063084939357, -0.5023894932670303, -0.5007752879124893, -0.4991636840181477, -0.497554673212447, -0.4959482471641733, -0.4943443975821988, -0.492743116215225, -0.49114439485152794, -0.4895482253187058, -0.4879545994834278, -0.48636350925118593, -0.4847749465660481, -0.4831889034104133, -0.48160537180476903, -0.4800243438074503, -0.4784458115144006, -0.4768697670589348, -0.47529620261150435, -0.47372511037946313, -0.4721564826068366, -0.4705903115740917, -0.46902658959790894, -0.46746530903095646, -0.4659064622616653, -0.4643500417140071, -0.46279603984727286, -0.461244449155854, -0.4596952621690246, -0.4581484714507259, -0.4566040695993518, -0.4550620492475365, -0.4535224030619437, -0.45198512374305727, -0.45045020402497354, -0.44891763667519546, -0.4473874144944278, -0.4458595303163746, -0.44433397700753746, -0.442810747467016, -0.44128983462630933, -0.4397712314491193, -0.4382549309311553, -0.43674092609994025, -0.4352292100146183, -0.433719775765764, -0.43221261647519266, -0.4307077252957724, -0.42920509541123736, -0.4277047200360028, -0.42620659241498077, -0.4247107058233981, -0.42321705356661476, -0.42172562897994476, -0.420236425428477, -0.4187494363068987, -0.4172646550393195, -0.4157820750790967, -0.41430168990866245, -0.41282349303935156, -0.41134747801123095, -0.4098736383929304, -0.40840196778147414, -0.4069324598021142, -0.40546510810816444, -0.4039999063808365, -0.4025368483290761, -0.40107592768940126, -0.3996171382257413, -0.3981604737292772, -0.39670592801828286, -0.39525349493796796, -0.3938031683603215, -0.39235494218395667, -0.39090881033395697, -0.3894647667617233, -0.38802280544482204, -0.3865829203868344, -0.3851451056172069, -0.38370935519110266, -0.3822756631892541, -0.3808440237178163, -0.3794144309082219, -0.3779868789170365, -0.37656136192581546, -0.37513787414096167, -0.373716409793584, -0.37229696313935773, -0.37087952845838434, -0.36946410005505365, -0.36805067225790666, -0.3666392394194989, -0.3652297959162653, -0.36382233614838555, -0.36241685453965067, -0.3610133455373305, -0.35961180361204204, -0.35821222325761876, -0.3568145989909808, -0.3554189253520061, -0.35402519690340223, -0.35263340823057976, -0.35124355394152545, -0.34985562866667735, -0.3484696270588002, -0.3470855437928617, -0.3457033735659101, -0.34432311109695163, -0.3429447511268303, -0.34156828841810705, -0.34019371775494045, -0.3388210339429683, -0.33745023180918965, -0.33608130620184795, -0.3347142519903149, -0.33334906406497494, -0.33198573733711084, -0.33062426673878975, -0.32926464722275023, -0.32790687376228983, -0.3265509413511539, -0.32519684500342466, -0.323844579753411, -0.32249414065553955, -0.321145522784246, -0.31979872123386727, -0.3184537311185346, -0.3171105475720669, -0.3157691657478656, -0.3144295808188092, -0.3130917879771492, -0.311755782434407, -0.3104215594212703, -0.30908911418749174, -0.30775844200178665, -0.3064295381517329, -0.3051023979436704, -0.30377701670260177, -0.30245338977209346, -0.3011315125141777, -0.2998113803092548, -0.29849298855599654, -0.2971763326712497, -0.29586140808994066, -0.2945482102649802, -0.2932367346671695, -0.291926976785106, -0.29061893212509066, -0.28931259621103517, -0.2880079645843703, -0.2867050328039543, -0.2854037964459825, -0.284104251103897, -0.282806392388297, -0.2815102159268503, -0.28021571736420453, -0.2789228923618994, -0.2776317365982795, -0.27634224576840777, -0.27505441558397903, -0.2737682417732349, -0.27248372008087823, -0.27120084626798907, -0.26991961611194054, -0.26864002540631543, -0.2673620699608234, -0.26608574560121867, -0.2648110481692181, -0.26353797352242, -0.26226651753422325, -0.2609966760937474, -0.25972844510575227, -0.2584618204905593, -0.2571967981839726, -0.25593337413720063, -0.2546715443167785, -0.2534113047044908, -0.25215265129729464, -0.2508955801072435, -0.24964008716141148, -0.24838616850181774, -0.24713382018535185, -0.24588303828369923, -0.2446338188832673, -0.24338615808511202, -0.24214005200486485, -0.24089549677266014, -0.23965248853306315, -0.23841102344499823, -0.23717109768167774, -0.23593270743053116, -0.23469584889313483, -0.23346051828514208, -0.2322267118362136, -0.23099442578994858, -0.22976365640381594, -0.22853439994908623, -0.22730665271076383, -0.22608041098751952, -0.22485567109162366, -0.22363242934887947, -0.2224106820985571, -0.22119042569332775, -0.2199716564991983, -0.21875437089544664, -0.21753856527455673, -0.21632423604215484, -0.21511137961694557, -0.21389999243064847, -0.21269007092793524, -0.21148161156636686, -0.2102746108163316, -0.20906906516098295, -0.20786497109617835, -0.20666232513041796, -0.20546112378478373, -0.20426136359287966, -0.20306304110077095, -0.2018661528669248, -0.2006706954621511, -0.19947666546954337, -0.19828405948442024, -0.19709287411426712, -0.19590310597867838, -0.1947147517092997, -0.19352780794977098, -0.1923422713556693, -0.19115813859445258, -0.18997540634540316, -0.18879407129957204, -0.18761413015972336, -0.18643557964027913, -0.1852584164672643, -0.1840826373782523, -0.18290823912231072, -0.1817352184599473, -0.18056357216305657, -0.17939329701486623, -0.17822438980988434, -0.17705684735384666, -0.17589066646366416, -0.17472584396737106, -0.17356237670407304, -0.17240026152389565, -0.17123949528793336, -0.1700800748681985, -0.16892199714757083, -0.16776525901974712, -0.1666098573891913, -0.1654557891710846, -0.1643030512912763, -0.16315164068623442, -0.16200155430299706, -0.16085278909912365, -0.15970534204264683, -0.15855921011202426, -0.157414390296091, -0.15627087959401204, -0.15512867501523503, -0.15398777357944343, -0.1528481723165098, -0.15170986826644947, -0.15057285847937432, -0.14943714001544695, -0.14830270994483516, -0.14716956534766645, -0.14603770331398302, -0.14490712094369695, -0.14377781534654552, -0.14264978364204697, -0.1415230229594564, -0.1403975304377219, -0.13927330322544096, -0.13815033848081718, -0.1370286333716171, -0.13590818507512742, -0.13478899077811235, -0.1336710476767711, -0.13255435297669602, -0.13143890389283036, -0.1303246976494269, -0.12921173148000623, -0.12810000262731575, -0.12698950834328857, -0.12588024588900282, -0.12477221253464107, -0.12366540555944999, -0.12255982225170037, -0.12145545990864716, -0.12035231583648989, -0.1192503873503332, -0.11814967177414766, -0.11705016644073077, -0.11595186869166818, -0.1148547758772951, -0.11375888535665803, -0.11266419449747649, -0.11157070067610518, -0.11047840127749624, -0.10938729369516165, -0.10829737533113604, -0.10720864359593946, -0.1061210959085405, -0.10503472969631966, -0.10394954239503268, -0.10286553144877435, -0.10178269430994236, -0.10070102843920131, -0.09962053130544712, -0.09854120038577135, -0.09746303316542594, -0.096386027137788, -0.0953101798043249, -0.09423548867455944, -0.09316195126603533, -0.09208956510428269, -0.0910183277227839, -0.08994823666293952, -0.08887928947403448, -0.08781148371320434, -0.08674481694540184, -0.08567928674336361, -0.08461489068757694, -0.08355162636624688, -0.08248949137526347, -0.08142848331816903, -0.08036859980612585, -0.07930983845788378, -0.07825219689974826, -0.07719567276554828, -0.07614026369660473, -0.07508596734169867, -0.07403278135704001, -0.07298070340623623, -0.07192973116026122, -0.07087986229742442, -0.06983109450334, -0.06878342547089629, -0.06773685290022526, -0.06669137449867228, -0.065646987980766, -0.06460369106818832, -0.0635614814897445, -0.06252035698133393, -0.061480315285919934, -0.06044135415350087, -0.059403471341080816, -0.0583666646126405, -0.05733093173910843, -0.05629627049833211, -0.055262678675049415, -0.0542301540608602, -0.05319869445419793, -0.052168297660301524, -0.05113896149118736, -0.050110683765621375, -0.04908346230909134, -0.048057294953779264, -0.047032179538533954, -0.0460081139088437, -0.044985095916809104, -0.04396312342111606, -0.042942194287008836, -0.04192230638626336, -0.040903457597160554, -0.03988564580445989, -0.03886886889937302, -0.03785312477953757, -0.03683841134899103, -0.03582472651814487, -0.03481206820375864, -0.03380043432891434, -0.03278982282299084, -0.03178023162163846, -0.03077165866675366, -0.02976410190645386, -0.02875755929505242, -0.027752028793033685, -0.026747508367028223, -0.02574399598978813, -0.024741489640162484, -0.023739987303072942, -0.02273948696948941, -0.021739986636405875, -0.020741484306816355, -0.019743977989690933, -0.01874746569995196, -0.01775194545845034, -0.01675741529194195, -0.015763873233064173, -0.014771317320312543, -0.013779745598017512, -0.012789156116321336, -0.011799546931155055, -0.010810916104215617, -0.009823261702943092, -0.008836581800498, -0.007850874475738767, -0.006866137813199274, -0.0058823699030665245, -0.004899568841158425, -0.003917732728901664, -0.0029368596733097135, -0.001956947786960924, -0.000977995187976737, 0.0};
    return table[static_cast<int>(x * 1024)];
}

template<typename freq_t>
FUNC float entropy(const freq_t *hist, int size)
{
    float sum = 0;
    for (int i = 0; i < size; ++i)
        sum += hist[i];

    if (sum == 0)
        return 0;

    float entropy = 0.0f;
    for (int i = 0; i < size; ++i)
    {
        auto prob = cut::clamp(hist[i] / sum, 0.0f, 1.0f);

        if (prob > 0.0f)
            entropy -= prob * e_log2(prob);
    }
    return powf(2.f, entropy) / static_cast<float>(size);
}

#endif // ENTROPY_H
